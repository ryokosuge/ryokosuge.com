---
import Layout from "../../layouts/Layout.astro";
import SideBar from "../../components/SideBar.astro";
import ArticlePost from "../../components/ArticlePost.astro";

import { fetchArticles, getArticle } from "../../libs/microcms";
import { SITE_DESCRIPTION, SITE_TITLE } from "../../config";

export const getStaticPaths = async () => {
  const articles = await fetchArticles();
  return articles.contents.map((article) => ({
    params: {
      articleId: article.id,
    },
  }));
};

const { articleId } = Astro.params;
const article = await getArticle({ articleID: articleId ?? "" });
---

<Layout
  siteTitle={`${article.title} | ${SITE_TITLE}`}
  siteDescription={SITE_DESCRIPTION}
  title={article.title}
  description={article.description}
  publishedAt={article.publishedAt}
>
  <SideBar showBackHome={true}>
    <ArticlePost article={article} />
  </SideBar>
</Layout>
